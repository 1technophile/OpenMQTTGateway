(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{280:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing.b1483dba.png"},281:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing2.47abb421.png"},282:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing3.027e5201.png"},283:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Thing4.2c183d74.png"},284:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy.01c59b58.png"},285:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy2.2e6c3e27.png"},286:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Policy3.23515811.png"},287:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate.8c12825c.png"},288:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate2.ed79e9b6.png"},289:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Create_Certificate3.3eba41ed.png"},290:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Policy.9d6aad48.png"},291:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Policy2.ab41e47b.png"},292:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Thing.5e692f8e.png"},293:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Attach_Thing2.06771663.png"},294:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_Find_Endpoint.a38acfc5.png"},295:function(t,a,e){t.exports=e.p+"assets/img/Integrate_AWS_IOT_result_MQTT.b8e18113.png"},401:function(t,a,e){"use strict";e.r(a);var s=e(14),n=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"integrate-aws-iot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#integrate-aws-iot"}},[t._v("#")]),t._v(" Integrate AWS IOT")]),t._v(" "),a("h2",{attrs:{id:"create-a-thing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-thing"}},[t._v("#")]),t._v(" Create a thing")]),t._v(" "),a("ul",[a("li",[t._v("From AWS console, search for IOT core")]),t._v(" "),a("li",[t._v("Create a Thing and name it, this name will be used as the OpenMQTTGateway name.")])]),t._v(" "),a("p",[a("img",{attrs:{src:e(280),alt:"AWS tutorial step"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(281),alt:"AWS tutorial step"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(282),alt:"AWS tutorial step"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(283),alt:"AWS tutorial step"}})]),t._v(" "),a("h2",{attrs:{id:"create-a-policy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-policy"}},[t._v("#")]),t._v(" Create a policy")]),t._v(" "),a("p",[a("img",{attrs:{src:e(284),alt:"AWS tutorial step"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(285),alt:"AWS tutorial step"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(286),alt:"AWS tutorial step"}})]),t._v(" "),a("ul",[a("li",[t._v("Add this json code to the policy")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-11-01"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Statement"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Effect"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Allow"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Action"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Connect"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Publish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Subscribe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iot:Receive"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"greengrass:Discover"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Resource"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("h2",{attrs:{id:"create-a-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-certificate"}},[t._v("#")]),t._v(" Create a certificate")]),t._v(" "),a("ul",[a("li",[t._v("Create a new certificate")])]),t._v(" "),a("p",[a("img",{attrs:{src:e(287),alt:"AWS tutorial step"}}),t._v(" "),a("img",{attrs:{src:e(288),alt:"AWS tutorial step"}})]),t._v(" "),a("ul",[a("li",[t._v("Download certificates and key")])]),t._v(" "),a("p",[a("img",{attrs:{src:e(289),alt:"AWS tutorial step"}})]),t._v(" "),a("h2",{attrs:{id:"attach-policy-with-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attach-policy-with-certificate"}},[t._v("#")]),t._v(" Attach Policy with certificate")]),t._v(" "),a("p",[a("img",{attrs:{src:e(290),alt:"AWS tutorial step"}}),t._v(" "),a("img",{attrs:{src:e(291),alt:"AWS tutorial step"}})]),t._v(" "),a("h2",{attrs:{id:"activate-certificate-and-attach-it-to-thing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activate-certificate-and-attach-it-to-thing"}},[t._v("#")]),t._v(" Activate certificate and attach it to Thing")]),t._v(" "),a("p",[a("img",{attrs:{src:e(292),alt:"AWS tutorial step"}}),t._v(" "),a("img",{attrs:{src:e(293),alt:"AWS tutorial step"}})]),t._v(" "),a("h2",{attrs:{id:"find-aws-endpoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-aws-endpoint"}},[t._v("#")]),t._v(" Find AWS EndPoint")]),t._v(" "),a("p",[a("img",{attrs:{src:e(294),alt:"AWS tutorial step"}})]),t._v(" "),a("h2",{attrs:{id:"gather-the-information-for-openmqttgateway-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gather-the-information-for-openmqttgateway-configuration"}},[t._v("#")]),t._v(" Gather the information for OpenMQTTGateway configuration")]),t._v(" "),a("p",[t._v("Now you should have the following information for the OpenMQTTGateway configuration:")]),t._v(" "),a("ul",[a("li",[t._v("Root certificate")]),t._v(" "),a("li",[t._v("Client certificate")]),t._v(" "),a("li",[t._v("Client key")]),t._v(" "),a("li",[t._v("End point url")]),t._v(" "),a("li",[t._v("Gateway name")])]),t._v(" "),a("h2",{attrs:{id:"modify-openmqttgateway-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modify-openmqttgateway-configuration"}},[t._v("#")]),t._v(" Modify OpenMQTTGateway configuration")]),t._v(" "),a("p",[t._v("With Arduino IDE, you can update the following field into User_config.h with the information gathered:")]),t._v(" "),a("ul",[a("li",[t._v("Gateway_Name")]),t._v(" "),a("li",[a("code",[t._v('MQTT_SERVER "xxxxxx.iot-eu-amazonaws.com"')])]),t._v(" "),a("li",[a("code",[t._v('MQTT_PORT "8883"')])]),t._v(" "),a("li",[a("code",[t._v("AWS_IOT true")])]),t._v(" "),a("li",[t._v("ss_server_cert with the root certificate")]),t._v(" "),a("li",[t._v("ss_client_cert with the client certificate")]),t._v(" "),a("li",[t._v("ss_client_key with the Client key")]),t._v(" "),a("li",[a("code",[t._v("MQTT_SECURE_SELF_SIGNED 1")])]),t._v(" "),a("li",[a("code",[t._v("MQTT_SECURE_DEFAULT true")])])]),t._v(" "),a("p",[t._v("With PlatformIO you can directly leverage the environment "),a("code",[t._v("esp32dev-ble-aws")])]),t._v(" "),a("h2",{attrs:{id:"build-and-upload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-and-upload"}},[t._v("#")]),t._v(" Build and upload")]),t._v(" "),a("h2",{attrs:{id:"connect-to-a-wifi-access-point-see-portal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-a-wifi-access-point-see-portal"}},[t._v("#")]),t._v(" Connect to a WiFi Access point "),a("a",{attrs:{href:"../upload/portal"}},[t._v("see portal")])]),t._v(" "),a("p",[t._v("Enter your credentials and verify that Secure connection is marked.")]),t._v(" "),a("h2",{attrs:{id:"verify-that-you-receive-data-in-aws"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#verify-that-you-receive-data-in-aws"}},[t._v("#")]),t._v(" Verify that you receive data in AWS")]),t._v(" "),a("ul",[a("li",[t._v("Go to things")]),t._v(" "),a("li",[t._v("Click on the thing created")]),t._v(" "),a("li",[t._v("Go to Activity")]),t._v(" "),a("li",[t._v("Click on MQTT Test Client")]),t._v(" "),a("li",[t._v("Subscribe to "),a("code",[t._v("+/#")])])]),t._v(" "),a("p",[t._v("You should see messages coming.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(295),alt:"AWS tutorial step"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);